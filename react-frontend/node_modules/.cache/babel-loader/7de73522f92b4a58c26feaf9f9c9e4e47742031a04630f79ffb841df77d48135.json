{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tadiwa.muguta\\\\Desktop\\\\Projects\\\\Finance Management\\\\financial_management_app\\\\react-frontend\\\\src\\\\Components\\\\SessionTimeout.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../Styling/SessionTimeout.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SessionTimeout = ({\n  setIsAuthenticated\n}) => {\n  _s();\n  const [timeLeft, setTimeLeft] = useState(null); // 3 minutes countdown (180 seconds)\n  const [showExpiredPopup, setShowExpiredPopup] = useState(false);\n  const sessionTimeout = 4 * 60 * 1000; // 5 minutes in milliseconds\n  const warningTime = 1 * 60 * 1000; // 2 minutes in milliseconds (3 minutes left)\n  const navigate = useNavigate();\n  const warningTimerRef = useRef(null);\n  const sessionTimerRef = useRef(null);\n  const countdownTimerRef = useRef(null);\n  const clearTimers = () => {\n    clearTimeout(warningTimerRef.current);\n    clearTimeout(sessionTimerRef.current);\n    clearInterval(countdownTimerRef.current);\n  };\n  const startCountdown = useCallback(() => {\n    let countdown = 180; // 3 minutes countdown\n    setTimeLeft(countdown);\n    countdownTimerRef.current = setInterval(() => {\n      countdown -= 1;\n      setTimeLeft(countdown);\n      console.log(countdown + \" seconds left.\");\n\n      // End countdown and redirect when time is up\n      if (countdown < 0) {\n        clearInterval(countdownTimerRef.current);\n        setShowExpiredPopup(true);\n\n        // Redirect after 3 seconds delay\n        setTimeout(() => {\n          setIsAuthenticated(false);\n          navigate('/');\n        }, 3000);\n      }\n    }, 1000);\n  }, [navigate, setIsAuthenticated]);\n  const resetTimers = useCallback(() => {\n    clearTimers();\n    setTimeLeft(null);\n    setShowExpiredPopup(false);\n    console.log(\"--------------------------TESTING resetTimers function-------------------------------\");\n\n    // Set a warning timer to start countdown 3 minutes before timeout\n    warningTimerRef.current = setTimeout(() => {\n      startCountdown();\n    }, warningTime);\n\n    // Redirect after session timeout\n    sessionTimerRef.current = setTimeout(() => {\n      alert(\"Session expired, redirecting...\");\n      setIsAuthenticated(false);\n      navigate('/');\n    }, sessionTimeout);\n  }, [navigate, sessionTimeout, warningTime, startCountdown, setIsAuthenticated]);\n  useEffect(() => {\n    console.log(\"--------------------------TESTING useEffect function-------------------------------\");\n\n    // Event listeners for user activity to reset timers\n    const resetOnActivity = () => resetTimers();\n    window.addEventListener('click', resetOnActivity);\n    window.addEventListener('pointermove', resetOnActivity);\n    window.addEventListener('keydown', resetOnActivity);\n\n    // Clean up timers and listeners on unmount\n    return () => {\n      clearTimers();\n      window.removeEventListener('click', resetOnActivity);\n      window.removeEventListener('pointermove', resetOnActivity);\n      window.removeEventListener('keydown', resetOnActivity);\n    };\n  }, [resetTimers]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [timeLeft <= 180 && timeLeft >= 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"session-timeout-warning\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Your session will expire in \", Math.floor(timeLeft / 60), \":\", timeLeft % 60 < 10 ? `0${timeLeft % 60}` : timeLeft % 60]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 17\n    }, this), showExpiredPopup && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"session-expired-popup\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Session expired, redirecting...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n};\n_s(SessionTimeout, \"nO+c4JefhoVATjicrEHpIHG3ES8=\", false, function () {\n  return [useNavigate];\n});\n_c = SessionTimeout;\nexport default SessionTimeout;\nvar _c;\n$RefreshReg$(_c, \"SessionTimeout\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useCallback","useNavigate","jsxDEV","_jsxDEV","SessionTimeout","setIsAuthenticated","_s","timeLeft","setTimeLeft","showExpiredPopup","setShowExpiredPopup","sessionTimeout","warningTime","navigate","warningTimerRef","sessionTimerRef","countdownTimerRef","clearTimers","clearTimeout","current","clearInterval","startCountdown","countdown","setInterval","console","log","setTimeout","resetTimers","alert","resetOnActivity","window","addEventListener","removeEventListener","children","className","Math","floor","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/tadiwa.muguta/Desktop/Projects/Finance Management/financial_management_app/react-frontend/src/Components/SessionTimeout.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../Styling/SessionTimeout.css';\r\n\r\nconst SessionTimeout = ({ setIsAuthenticated }) => {\r\n    const [timeLeft, setTimeLeft] = useState(null); // 3 minutes countdown (180 seconds)\r\n    const [showExpiredPopup, setShowExpiredPopup] = useState(false);\r\n    const sessionTimeout = 4 * 60 * 1000; // 5 minutes in milliseconds\r\n    const warningTime = 1 * 60 * 1000; // 2 minutes in milliseconds (3 minutes left)\r\n    const navigate = useNavigate();\r\n\r\n    const warningTimerRef = useRef(null);\r\n    const sessionTimerRef = useRef(null);\r\n    const countdownTimerRef = useRef(null);\r\n\r\n    const clearTimers = () => {\r\n        clearTimeout(warningTimerRef.current);\r\n        clearTimeout(sessionTimerRef.current);\r\n        clearInterval(countdownTimerRef.current);\r\n    };\r\n\r\n    const startCountdown = useCallback(() => {\r\n        let countdown = 180; // 3 minutes countdown\r\n        setTimeLeft(countdown);\r\n\r\n        countdownTimerRef.current = setInterval(() => {\r\n            countdown -= 1;\r\n            setTimeLeft(countdown);\r\n            console.log(countdown + \" seconds left.\")\r\n\r\n            // End countdown and redirect when time is up\r\n            if (countdown < 0) {\r\n                clearInterval(countdownTimerRef.current);\r\n                setShowExpiredPopup(true);\r\n                \r\n                // Redirect after 3 seconds delay\r\n                setTimeout(() => {\r\n                    setIsAuthenticated(false);\r\n                    navigate('/');\r\n                }, 3000);\r\n            }\r\n        }, 1000);\r\n    }, [navigate, setIsAuthenticated]);\r\n\r\n    const resetTimers = useCallback(() => {\r\n        clearTimers();\r\n        setTimeLeft(null);\r\n        setShowExpiredPopup(false);\r\n        console.log(\"--------------------------TESTING resetTimers function-------------------------------\");\r\n\r\n        // Set a warning timer to start countdown 3 minutes before timeout\r\n        warningTimerRef.current = setTimeout(() => {\r\n            startCountdown();\r\n        }, warningTime);\r\n\r\n        // Redirect after session timeout\r\n        sessionTimerRef.current = setTimeout(() => {\r\n            alert(\"Session expired, redirecting...\");\r\n            setIsAuthenticated(false);\r\n            navigate('/');\r\n        }, sessionTimeout);\r\n    }, [navigate, sessionTimeout, warningTime, startCountdown, setIsAuthenticated]);\r\n\r\n    useEffect(() => {\r\n        console.log(\"--------------------------TESTING useEffect function-------------------------------\")\r\n\r\n        // Event listeners for user activity to reset timers\r\n        const resetOnActivity = () => resetTimers();\r\n        window.addEventListener('click', resetOnActivity);\r\n        window.addEventListener('pointermove', resetOnActivity);\r\n        window.addEventListener('keydown', resetOnActivity);\r\n\r\n        // Clean up timers and listeners on unmount\r\n        return () => {\r\n            clearTimers();\r\n            window.removeEventListener('click', resetOnActivity);\r\n            window.removeEventListener('pointermove', resetOnActivity);\r\n            window.removeEventListener('keydown', resetOnActivity);\r\n        };\r\n    }, [resetTimers]);\r\n\r\n    return (\r\n        <div>\r\n            {timeLeft <= 180 && timeLeft >= 0 && (\r\n                <div className=\"session-timeout-warning\">\r\n                    <p>Your session will expire in {Math.floor(timeLeft / 60)}:{timeLeft % 60 < 10 ? `0${timeLeft % 60}` : timeLeft % 60}</p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Show the expired popup if timeLeft is 0 */}\r\n            {showExpiredPopup && (\r\n                <div className=\"session-expired-popup\">\r\n                    <p>Session expired, redirecting...</p>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SessionTimeout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}